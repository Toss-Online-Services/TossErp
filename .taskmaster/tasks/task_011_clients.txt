# Task ID: 11
# Title: AI Service (Service-as-a-Software)
# Status: pending
# Dependencies: 1, 4, 5, 6, 7, 8, 9, 10
# Priority: high
# Description: Conversational orchestrator, agents, background monitors, outcome tracking
# Details:
MVP orchestration with Inventory, Sales, Purchasing, Finance, Customer agents

# Test Strategy:


# Subtasks:
## 1. Public endpoints: /api/ai/conversation, /automate, /services/status, /outcomes [pending]
### Dependencies: None
### Description: 
### Details:


## 2. Intent classification + routing (keyword + rule-based + fallback) [pending]
### Dependencies: None
### Description: 
### Details:


## 3. Request validation + authorization policies (per intent) [pending]
### Dependencies: None
### Description: 
### Details:


## 4. Inventory agent: low stock check, reorder recs, auto-PO draft [pending]
### Dependencies: None
### Description: 
### Details:


## 5. Sales agent: process sale request, generate invoice, send receipt [pending]
### Dependencies: None
### Description: 
### Details:


## 6. Purchasing agent: create PO, receive goods, supplier selection hint [pending]
### Dependencies: None
### Description: 
### Details:


## 7. Finance agent: cash flow snapshot, monthly P&L summary, overdue alerts [pending]
### Dependencies: None
### Description: 
### Details:


## 8. Customer agent: follow-ups for lapsed customers, answer FAQs [pending]
### Dependencies: None
### Description: 
### Details:


## 9. Proactive monitor: schedules + event hooks (low stock, overdue invoices, churn) [pending]
### Dependencies: None
### Description: 
### Details:


## 10. Automation scheduler: cron-like recurring tasks (daily/weekly/monthly) [pending]
### Dependencies: None
### Description: 
### Details:


## 11. Outcome tracker: define KPIs (revenue↑, stockouts↓, time saved), persist [pending]
### Dependencies: None
### Description: 
### Details:


## 12. Outcome analytics: service performance metrics + ROI report endpoints [pending]
### Dependencies: None
### Description: 
### Details:


## 13. Idempotency + retries + circuit breakers on downstream calls [in-progress]
### Dependencies: None
### Description: 
### Details:
Progress (2025-08-20): Idempotency middleware implemented for AgentManager & Orchestrator (Idempotency-Key + body hash, 10m cache) with tests. Pending: Polly retry & circuit breaker policies on outbound HTTP clients (LLM calls, future service clients) and metrics integration.

## 14. Structured errors + ProblemDetails for all endpoints [pending]
### Dependencies: None
### Description: 
### Details:


## 15. Observability: traces around orchestration spans + agent actions [pending]
### Dependencies: None
### Description: 
### Details:


## 16. Integration tests: orchestrator→agents happy/edge paths [pending]
### Dependencies: None
### Description: 
### Details:


## 17. Load smoke: conversation/automation p95 latency check [pending]
### Dependencies: None
### Description: 
### Details:


## 18. Docs: swagger annotations + examples for every endpoint [pending]
### Dependencies: None
### Description: 
### Details:


